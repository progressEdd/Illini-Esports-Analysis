excercise<-X8_Review_excercise_excel
#what is the mean and standard deviation of Age?
mean(excercise$Age, na.rm = TRUE)
sd(excercise$Age, na.rm = TRUE)

#what is the range of View_length?
range(excercise$View_length)

#what is the mean of View_length in the two states?
aggregate(excercise$View_length, list(excercise$State), mean)

mean(excercise$View_length[excercise$State=="IL"])

#what is average View_length of male and female?
aggregate(excercise$View_length, list(excercise$Gender), mean)

#histogram of Age, graph title "Distribution of age",x label "Age", y label"Frequency"
#Make the x from 0 to 80, y from 0 to 20
hist(excercise$Age,main = "Distribution of age",xlab = "Age", ylab="Frequency",
     xlim = c(0,80), ylim = c(0,20))


#Separate histogram of Age for viewers who liked the video, and did not like the video
hist(excercise$Age[excercise$Like=='Y'],main = "Distribution of age - like",xlab = "Age", ylab="Frequency",
     xlim = c(0,80), ylim = c(0,20))
hist(excercise$Age[excercise$Like=='N'],main = "Distribution of age - dislike",xlab = "Age", ylab="Frequency",
     xlim = c(0,80), ylim = c(0,20))

#Use a graph to show if there is any relationship between Age and number of friends?
plot(x=excercise$Age, y=excercise$Friends)

#Use a graph to show if there is any relationship between Age and how long the viewer watch the video?
plot(x=excercise$Age, y=excercise$View_length)

#Use the first 35 viewer as training set, build a KNN model to predict whether the 
#last 5 viewers will watch the video? 
#(Use only numeric features to build the model, ID should not be used )
colnames(excercise)

KNNdata<-excercise[,c(2,5,6,7)]

KNNtrain<-KNNdata[c(1:35),]
KNNtest<-KNNdata[c(36:40),]

KNNtrain[is.na(KNNtrain)]<-0
colnames(KNNtrain)
set.seed(1)
fit <- train( KNNtrain[,-4],KNNtrain$Like ,
              preProcess = c("center","scale"),
              method = "knn",
              tuneLength = 10)
fit
plot(fit)
KNNtest[is.na(KNNtest)]<-0
predictknn<-predict(fit,KNNtest)
predictknn
# Compare to the actual values, how many cases out of the 5 cases are correctly predicted?
KNNtest<-cbind(KNNtest,predictknn)
View(KNNtest)
table(KNNtest$Like,KNNtest$predictknn)

